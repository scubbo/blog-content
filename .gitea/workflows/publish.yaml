name: Gitea Actions Demo
run-name: ${{ gitea.actor }} is testing out Gitea Actions! ðŸš€
on: [push]

jobs:
  checkout:
    runs-on: ubuntu-latest
    steps:
      # Despite not being present in the QuickStart instructions, this step is necessary in order to install `node`,
      # which is itself required for `actions/checkout`
      # Cannot use `actions/setup-node` because that _itself_ requires `node` (it makes it available to user-code,
      # rather than to the system. Interesting discussion [here](https://gitea.com/gitea/act_runner/issues/538))
      - name: Install node
        run: apt-get update && apt-get install -y nodejs

      - name: Check out repository code
        uses: actions/checkout@v4

  block-posts-containining-tk:
    depends-on:
      - checkout
    runs-on: alpine
    steps:
      - shell: /bin/sh
        run: apk add --no-cache bash
      - run: |
          echo "Hello World"
          echo "Goodbye Mars"
    
  build-blog:
    depends-on:
      - block-posts-containining-tk
    runs-on: alpine
    steps:
      - shell: /bin/sh
        run: apk add --no-cache bash
      - run: |
          apk add --no-cache hugo git
          git submodule init
          git submodule update --recursive
          hugo --source blog
  
  # TODO - build image, then publish